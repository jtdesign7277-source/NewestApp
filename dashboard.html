<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Dashboard | ApeHub</title>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-primary: #0a0a0f;
      --bg-secondary: #111118;
      --bg-card: rgba(255, 255, 255, 0.03);
      --bg-card-hover: rgba(255, 255, 255, 0.06);
      --bg-solid: #1a1a24;
      --text-primary: #fff;
      --text-secondary: rgba(255, 255, 255, 0.6);
      --text-muted: rgba(255, 255, 255, 0.4);
      --border-color: rgba(255, 255, 255, 0.15);
      --border-light: rgba(255, 255, 255, 0.1);
      --accent: #a855f7;
      --accent-glow: rgba(168, 85, 247, 0.3);
      --nav-bg: rgba(10, 10, 15, 0.95);
      --card-bg: #16161d;
      --input-bg: rgba(255, 255, 255, 0.08);
    }

    [data-theme="light"] {
      --bg-primary: #f8f9fa;
      --bg-secondary: #ffffff;
      --bg-card: rgba(0, 0, 0, 0.04);
      --bg-card-hover: rgba(0, 0, 0, 0.08);
      --bg-solid: #ffffff;
      --text-primary: #000000;
      --text-secondary: #333333;
      --text-muted: #555555;
      --border-color: rgba(0, 0, 0, 0.15);
      --border-light: rgba(0, 0, 0, 0.1);
      --accent: #7c3aed;
      --accent-glow: rgba(124, 58, 237, 0.15);
      --nav-bg: rgba(255, 255, 255, 0.95);
      --card-bg: #ffffff;
      --input-bg: #f0f0f5;
    }

    body {
      background: var(--bg-primary);
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Instrument Sans', sans-serif;
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      transition: background 0.3s ease, color 0.3s ease;
    }

    /* ============================================
       MAIN CONTAINER
       ============================================ */
    .dashboard-container {
      max-width: 500px;
      margin: 0 auto;
      padding: 0;
      padding-bottom: 100px;
    }

    /* ============================================
       TOP BAR - Logo Left, Welcome Right
       ============================================ */
    .top-bar {
      padding: 60px 24px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* ============================================
       CLOCK SECTION
       ============================================ */
    .clock-section {
      padding: 8px 24px 24px;
    }

    .clock-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .time-row {
      display: flex;
      align-items: baseline;
      gap: 6px;
    }

    .current-time {
      font-size: 24px;
      font-weight: 600;
      font-variant-numeric: tabular-nums;
      letter-spacing: -1px;
      color: var(--text-primary);
    }

    .time-period {
      font-size: 12px;
      color: var(--text-muted);
      font-weight: 500;
    }

    .market-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }

    .status-dot.open {
      background: #00d775;
      box-shadow: 0 0 8px #00d775;
    }

    .status-dot.closed {
      background: #ff4757;
      box-shadow: 0 0 8px #ff4757;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }

    .status-text {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-muted);
    }

    .countdown {
      font-size: 11px;
      font-weight: 600;
      color: var(--accent);
      font-variant-numeric: tabular-nums;
      transition: color 0.3s ease;
    }

    .countdown.closing {
      color: #ff4757;
    }

    .countdown.opening {
      color: #00d775;
    }

    .countdown-label {
      font-size: 11px;
      color: var(--text-muted);
    }

    .apehub-logo {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .apehub-logo span {
      color: var(--accent);
    }

    .welcome {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-secondary);
      text-align: right;
      cursor: pointer;
      transition: all 0.2s ease;
      padding: 8px 12px;
      border-radius: 12px;
      margin: -8px -12px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .welcome-arrow {
      opacity: 0.5;
      transition: transform 0.2s ease, opacity 0.2s ease;
    }

    .welcome:hover .welcome-arrow {
      opacity: 1;
      transform: translateX(2px);
    }

    .welcome:hover {
      background: var(--accent-glow);
    }

    .welcome:active {
      transform: scale(0.98);
    }

    .welcome span {
      color: var(--accent);
      font-weight: 600;
    }

    /* ============================================
       USER PROFILE PANEL
       ============================================ */
    .profile-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .profile-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .profile-panel {
      position: fixed;
      top: 0;
      right: -100%;
      width: 100%;
      max-width: 380px;
      height: 100%;
      background: var(--bg-primary);
      z-index: 1000;
      transition: right 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      display: flex;
      flex-direction: column;
      border-left: 1px solid var(--border-color);
    }

    .profile-panel.active {
      right: 0;
    }

    .profile-header {
      padding: 50px 20px 16px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .profile-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .profile-close {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-card);
      border: none;
      color: var(--text-primary);
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;\n    }
    }

    .profile-close:hover {
      background: var(--bg-card-hover);
    }

    .profile-content {
      flex: 1;
      overflow-y: auto;
      padding: 16px 20px;
    }

    .profile-avatar-section {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 12px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      margin-bottom: 16px;
    }

    .profile-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: linear-gradient(135deg, #a855f7, #7c3aed);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 600;
      color: #fff;
      flex-shrink: 0;
    }

    .profile-user-info {
      display: flex;
      flex-direction: column;
    }

    .profile-name {
      font-size: 17px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .profile-handle {
      font-size: 13px;
      color: var(--text-muted);
    }

    .profile-info-section {
      margin-bottom: 16px;
    }

    .profile-info-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 12px;
    }

    .profile-info-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 0;
      border-bottom: 1px solid var(--border-light);
    }

    .profile-info-item:last-child {
      border-bottom: none;
    }

    .profile-info-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: var(--accent-glow);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent);
      font-size: 18px;
    }

    .profile-info-content {
      flex: 1;
    }

    .profile-info-label {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 2px;
    }

    .profile-info-value {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
    }

    /* ============================================
       SUPPORT CHAT WIDGET
       ============================================ */
    .support-section {
      background: var(--accent-glow);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 24px;
    }

    .support-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .support-icon {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      background: linear-gradient(135deg, #a855f7, #7c3aed);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .support-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .support-subtitle {
      font-size: 13px;
      color: var(--text-muted);
    }

    .chat-messages {
      max-height: 200px;
      overflow-y: auto;
      margin-bottom: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .chat-message {
      padding: 12px 14px;
      border-radius: 16px;
      max-width: 85%;
      font-size: 14px;
      line-height: 1.4;
    }

    .chat-message.support {
      background: var(--bg-card);
      color: var(--text-primary);
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }

    .chat-message.user {
      background: var(--accent);
      color: #fff;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }

    .chat-message-time {
      font-size: 10px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .chat-input-row {
      display: flex;
      gap: 8px;
    }

    .chat-input {
      flex: 1;
      background: var(--input-bg);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 12px 16px;
      color: var(--text-primary);
      font-size: 14px;
      outline: none;
      transition: all 0.2s ease;
    }

    .chat-input:focus {
      border-color: var(--accent);
      background: var(--accent-glow);
    }

    .chat-input::placeholder {
      color: var(--text-muted);
    }

    .chat-send {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: #a855f7;
      border: none;
      color: #fff;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .chat-send:hover {
      background: #9333ea;
      transform: scale(1.05);
    }

    .chat-send:active {
      transform: scale(0.95);
    }

    .profile-logout {
      width: 100%;
      padding: 16px;
      background: rgba(255, 71, 87, 0.1);
      border: 1px solid rgba(255, 71, 87, 0.2);
      border-radius: 12px;
      color: #ff4757;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .profile-logout:hover {
      background: rgba(255, 71, 87, 0.2);
    }

    /* Theme Toggle */
    .theme-section {
      margin-bottom: 16px;
    }

    .theme-toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 0;
    }

    .theme-toggle-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .theme-toggle-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: rgba(168, 85, 247, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }

    .theme-toggle-label {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .theme-toggle-sublabel {
      font-size: 12px;
      color: var(--text-muted);
    }

    .theme-switch {
      position: relative;
      width: 52px;
      height: 28px;
    }

    .theme-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .theme-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--border-color);
      border-radius: 28px;
      transition: all 0.3s ease;
    }

    .theme-slider:before {
      position: absolute;
      content: "";
      height: 22px;
      width: 22px;
      left: 3px;
      bottom: 3px;
      background: var(--text-primary);
      border-radius: 50%;
      transition: all 0.3s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .theme-switch input:checked + .theme-slider {
      background: #a855f7;
    }

    .theme-switch input:checked + .theme-slider:before {
      transform: translateX(24px);
    }

    .theme-icons {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 16px;
    }

    .theme-icon-dark, .theme-icon-light {
      opacity: 0.4;
      transition: opacity 0.3s ease;
    }

    [data-theme="dark"] .theme-icon-dark,
    [data-theme="light"] .theme-icon-light {
      opacity: 1;
    }

    /* ============================================
       INDICES STRIP
       ============================================ */
    .indices-section {
      padding: 16px 0 32px;
      border-top: 1px solid rgba(255, 255, 255, 0.6);
      border-bottom: 1px solid rgba(255, 255, 255, 0.6);
    }

    .indices-header {
      padding: 0 24px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .indices-title {
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 600;
      letter-spacing: 1.5px;
      text-transform: uppercase;
    }

    .market-status-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 500;
    }

    .market-status-badge .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #00d775;
    }

    .indices-scroll {
      display: flex;
      gap: 0;
      overflow-x: auto;
      padding: 0 24px;
      -webkit-overflow-scrolling: touch;
    }

    .indices-scroll::-webkit-scrollbar {
      display: none;
    }

    .index-item {
      flex: 0 0 auto;
      min-width: 120px;
      padding: 0 20px 0 0;
      border-right: 1px solid var(--border-color);
    }

    .index-item:last-child {
      border-right: none;
      padding-right: 0;
    }

    .index-item:first-child {
      padding-left: 0;
    }

    .index-name {
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 500;
      margin-bottom: 4px;
      letter-spacing: 0.3px;
    }

    .index-value {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .index-change {
      font-size: 13px;
      font-weight: 600;
    }

    .index-change.up {
      color: #00d775;
    }

    .index-change.down {
      color: #ff4757;
    }

    .market-price {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .market-change {
      font-size: 14px;
      font-weight: 600;
    }

    .market-change.up {
      color: #00d775;
    }

    .market-change.down {
      color: #ff4757;
    }

    /* ============================================
       WATCHLIST SECTION
       ============================================ */
    .watchlist-section {
      padding: 32px 24px 24px;
    }

    .wl-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 24px;
    }

    .wl-title-section {
      flex: 1;
    }

    .wl-list-name {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      letter-spacing: 1.5px;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    .wl-total-value {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
      cursor: pointer;
    }

    .wl-total-amount {
      font-size: 32px;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: -1px;
      order: 1;
    }

    .wl-total-change {
      font-size: 14px;
      font-weight: 600;
      color: #00d775;
      order: 2;
    }

    .wl-total-change.down {
      color: #ff4757;
    }

    /* Gunmetal shiny stars for hidden values */
    .hidden-stars {
      background: linear-gradient(135deg, #2a2d33 0%, #4a4f5a 25%, #6b7280 50%, #4a4f5a 75%, #2a2d33 100%);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gunmetalShine 3s ease-in-out infinite;
      text-shadow: none;
      font-weight: 400;
      letter-spacing: 2px;
    }

    @keyframes gunmetalShine {
      0%, 100% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
    }

    .wl-header-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .wl-eye-btn {
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      padding: 8px;
      transition: all 0.2s;
    }

    .wl-eye-btn:hover {
      color: var(--text-secondary);
    }

    .wl-eye-btn .eye-open {
      display: block;
    }

    .wl-eye-btn .eye-closed {
      display: none;
    }

    .wl-eye-btn.hidden .eye-open {
      display: none;
    }

    .wl-eye-btn.hidden .eye-closed {
      display: block;
    }

    /* Watchlist collapse toggle */
    .wl-collapse-row {
      display: flex;
      justify-content: center;
      padding: 8px 0;
    }

    .wl-collapse-btn {
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      padding: 4px 16px;
      transition: all 0.3s;
    }

    .wl-collapse-btn:hover {
      color: var(--text-secondary);
    }

    .wl-collapse-btn.collapsed {
      transform: rotate(180deg);
    }

    /* ============================================
       SEARCH BAR
       ============================================ */
    .wl-search-container {
      position: relative;
      margin-bottom: 24px;
    }

    .wl-search-input {
      width: 100%;
      padding: 14px 20px;
      padding-left: 48px;
      padding-right: 48px;
      border: none;
      border-radius: 14px;
      font-size: 15px;
      background: var(--input-bg);
      color: var(--text-primary);
      outline: none;
      transition: all 0.2s;
    }

    .wl-search-input::placeholder {
      color: var(--text-muted);
    }

    .wl-search-input:focus {
      background: var(--bg-card-hover);
      box-shadow: 0 0 0 2px var(--accent-glow);
    }

    .wl-search-icon {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      pointer-events: none;
    }

    .wl-search-clear {
      position: absolute;
      right: 14px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      padding: 4px;
      border-radius: 50%;
      display: none;
      transition: color 0.2s;
    }

    .wl-search-clear:hover {
      color: var(--text-primary);
    }

    .wl-search-clear.visible {
      display: block;
    }

    /* ============================================
       SEARCH RESULTS DROPDOWN
       ============================================ */
    .wl-search-results {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      right: 0;
      background: var(--bg-solid);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
    }

    .wl-search-results.visible {
      display: block;
    }

    .wl-search-result {
      display: grid;
      grid-template-columns: 1fr auto auto auto;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      border-bottom: 1px solid var(--border-light);
      cursor: pointer;
      transition: background 0.2s;
    }

    .wl-search-result:last-child {
      border-bottom: none;
    }

    .wl-search-result:hover {
      background: var(--bg-card-hover);
    }

    .wl-result-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
    }

    .wl-result-symbol {
      font-weight: 700;
      font-size: 15px;
      color: var(--text-primary);
    }

    .wl-result-name {
      font-size: 13px;
      color: var(--text-muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .wl-result-sparkline {
      width: 80px;
      height: 30px;
    }

    .wl-result-price-col {
      text-align: right;
      min-width: 70px;
    }

    .wl-result-price {
      font-weight: 600;
      font-size: 15px;
      color: var(--text-primary);
    }

    .wl-result-change {
      font-size: 12px;
      font-weight: 600;
      padding: 3px 8px;
      border-radius: 4px;
      margin-top: 4px;
      display: inline-block;
    }

    .wl-result-change.up {
      background: #00d775;
      color: #000;
    }

    .wl-result-change.down {
      background: #ff4757;
      color: #fff;
    }

    /* Star button */
    .wl-star-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 4px;
    }

    .wl-star-btn:hover {
      background: rgba(255, 215, 0, 0.15);
    }

    .wl-star-btn svg {
      width: 22px;
      height: 22px;
      transition: all 0.2s;
    }

    .wl-star-btn .star-empty {
      color: var(--text-muted);
    }

    .wl-star-btn .star-filled {
      color: #FFD700;
      display: none;
    }

    .wl-star-btn.active .star-empty {
      display: none;
    }

    .wl-star-btn.active .star-filled {
      display: block;
    }

    /* No results */
    .wl-no-results {
      padding: 30px;
      text-align: center;
      color: var(--text-muted);
      font-size: 14px;
    }

    /* ============================================
       WATCHLIST LABEL
       ============================================ */
    .watchlist-label-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .watchlist-label {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      letter-spacing: 1.5px;
      text-transform: uppercase;
    }

    /* ============================================
       STOCK LIST (Main Watchlist)
       ============================================ */
    .wl-stock-list {
      max-height: 2000px;
      overflow: hidden;
      transition: max-height 0.4s ease, opacity 0.3s ease;
    }

    .wl-stock-list.collapsed {
      max-height: 0;
      opacity: 0;
    }

    .wl-stock-row {
      display: grid;
      grid-template-columns: 1fr 80px auto 24px;
      align-items: center;
      gap: 12px;
      padding: 16px 0;
      border-bottom: 1px solid var(--border-light);
      transition: background 0.2s;
      position: relative;
      cursor: pointer;
    }

    .wl-stock-row:active {
      background: var(--bg-card-hover);
    }

    .wl-stock-row:last-child {
      border-bottom: none;
    }

    .wl-stock-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
    }

    .wl-stock-symbol {
      font-weight: 600;
      font-size: 16px;
      color: var(--text-primary);
      letter-spacing: -0.3px;
    }

    .wl-stock-name {
      font-size: 13px;
      color: var(--text-muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .wl-stock-sparkline {
      width: 80px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .wl-stock-price-col {
      text-align: right;
      min-width: 80px;
    }

    .wl-stock-price {
      font-weight: 600;
      font-size: 16px;
      color: var(--text-primary);
    }

    .wl-stock-change {
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .wl-stock-change.up {
      color: #00d775;
    }

    .wl-stock-change.down {
      color: #ff4757;
    }

    /* Remove button */
    .wl-remove-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      opacity: 0.3;
      transition: all 0.2s;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .wl-stock-row:hover .wl-remove-btn {
      opacity: 1;
    }

    .wl-remove-btn:hover {
      color: #ff4757;
    }

    /* ============================================
       EMPTY STATE
       ============================================ */
    .wl-empty {
      padding: 60px 24px;
      text-align: center;
      color: var(--text-muted);
    }

    .wl-empty-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.3;
    }

    .wl-empty h3 {
      font-size: 18px;
      color: var(--text-secondary);
      margin-bottom: 8px;
      font-weight: 500;
    }

    .wl-empty p {
      font-size: 14px;
      color: var(--text-muted);
    }

    /* ============================================
       TOAST
       ============================================ */
    .wl-toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--bg-card);
      color: var(--text-primary);
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      z-index: 1000;
      opacity: 0;
      transition: all 0.3s ease;
    }

    .wl-toast.visible {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    .wl-toast.success {
      border-left: 3px solid #00d775;
    }

    .wl-toast.removed {
      border-left: 3px solid #ff4757;
    }

    /* ============================================
       MODAL
       ============================================ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      padding: 20px;
    }

    .modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border-radius: 20px;
      width: 100%;
      max-width: 380px;
      padding: 24px;
      transform: scale(0.9) translateY(20px);
      transition: transform 0.3s ease;
      border: 1px solid var(--border-color);
    }

    .modal-overlay.visible .modal-content {
      transform: scale(1) translateY(0);
    }

    .modal-handle {
      display: none;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 24px;
    }

    .modal-stock-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .modal-symbol {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .modal-name {
      font-size: 14px;
      color: var(--text-muted);
    }

    .modal-price-info {
      text-align: right;
    }

    .modal-current-price {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .modal-price-change {
      font-size: 14px;
      font-weight: 600;
    }

    .modal-price-change.up {
      color: #00d775;
    }

    .modal-price-change.down {
      color: #ff4757;
    }

    .modal-form {
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      width: 100%;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-label {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      text-align: center;
    }

    .form-input {
      background: var(--input-bg);
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      outline: none;
      transition: all 0.2s;
      text-align: center;
    }

    .form-input::placeholder {
      color: var(--text-muted);
    }

    .form-input:focus {
      background: var(--bg-card-hover);
      box-shadow: 0 0 0 2px var(--accent-glow);
    }

    .form-display {
      background: var(--input-bg);
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      text-align: center;
      opacity: 0.7;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .position-summary {
      width: 100%;
    }

    .modal-buttons {
      width: 100%;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .position-summary {
      background: var(--input-bg);
      border-radius: 12px;
      padding: 16px;
      margin-top: 8px;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
    }

    .summary-row:not(:last-child) {
      border-bottom: 1px solid var(--border-light);
    }

    .summary-label {
      font-size: 14px;
      color: var(--text-muted);
    }

    .summary-value {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .summary-value.gain {
      color: #00d775;
    }

    .summary-value.loss {
      color: #ff4757;
    }

    .modal-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 8px;
    }

    .modal-btn {
      flex: 1;
      padding: 12px 16px;
      background: var(--bg-card);
      border: 2px solid transparent;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.2s;
    }

    .modal-btn-cancel {
      background: var(--input-bg);
      border-color: var(--border-color);
      color: var(--text-secondary);
    }

    .modal-btn-cancel:hover {
      background: var(--bg-card-hover);
      border-color: var(--text-muted);
      color: var(--text-primary);
    }

    .modal-btn-save {
      background: rgba(168, 85, 247, 0.1);
      border-color: #a855f7;
      color: #a855f7;
      box-shadow: 0 0 12px rgba(168, 85, 247, 0.3), inset 0 0 8px rgba(168, 85, 247, 0.1);
    }

    .modal-btn-save:hover {
      background: rgba(168, 85, 247, 0.2);
      box-shadow: 0 0 16px rgba(168, 85, 247, 0.5), inset 0 0 12px rgba(168, 85, 247, 0.15);
    }

    .modal-btn-add {
      background: rgba(0, 215, 117, 0.1);
      border-color: #00d775;
      color: #00d775;
      box-shadow: 0 0 12px rgba(0, 215, 117, 0.3), inset 0 0 8px rgba(0, 215, 117, 0.1);
    }

    .modal-btn-add:hover {
      background: rgba(0, 215, 117, 0.2);
      box-shadow: 0 0 16px rgba(0, 215, 117, 0.5), inset 0 0 12px rgba(0, 215, 117, 0.15);
    }

    .modal-buttons {
      display: flex;
      gap: 8px;
      background: var(--input-bg);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 4px;
    }

    /* ============================================
       CONFETTI CELEBRATION
       ============================================ */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10000;
      overflow: hidden;
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      top: -10px;
      animation: confetti-fall linear forwards;
    }

    .confetti.square {
      border-radius: 2px;
    }

    .confetti.circle {
      border-radius: 50%;
    }

    .confetti.strip {
      width: 4px;
      height: 16px;
      border-radius: 2px;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(0) rotate(0deg) scale(1);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg) scale(0.5);
        opacity: 0;
      }
    }

    /* ============================================
       BOTTOM NAV
       ============================================ */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-primary);
      border-top: 1px solid rgba(255, 255, 255, 0.6);
      display: flex;
      justify-content: space-around;
      padding: 12px 0 28px;
      max-width: 500px;
      margin: 0 auto;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      color: var(--text-muted);
      text-decoration: none;
      font-size: 11px;
      transition: color 0.2s;
    }

    .nav-item.active {
      color: var(--accent);
    }

    .nav-item svg {
      width: 24px;
      height: 24px;
    }

    /* ============================================
       SCROLLBAR
       ============================================ */
    ::-webkit-scrollbar {
      width: 4px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

        ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 2px;
    }

    /* Safe area for iOS */
    @supports (padding-bottom: env(safe-area-inset-bottom)) {
      .dashboard-container {
        padding-bottom: calc(100px + env(safe-area-inset-bottom));
      }
      .bottom-nav {
        padding-bottom: calc(12px + env(safe-area-inset-bottom));
      }
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    
    <!-- Top Bar -->
    <div class="top-bar">
      <div class="apehub-logo">Ape<span>Hub</span></div>
      <div class="welcome" onclick="openProfile()">Welcome, <span id="userName">User</span> <svg class="welcome-arrow" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg></div>
    </div>

    <!-- Clock Section -->
    <div class="clock-section">
      <div class="clock-left">
        <div class="time-row">
          <span class="current-time" id="currentTime">00:00:00</span>
          <span class="time-period" id="timePeriod">AM</span>
        </div>
        <div class="market-row">
          <div class="status-dot" id="statusDot"></div>
          <span class="status-text" id="statusText">Closed</span>
          <span class="countdown" id="countdown">00:00:00</span>
          <span class="countdown-label" id="countdownLabel">until open</span>
        </div>
      </div>
    </div>

    <!-- User Profile Panel -->
    <div class="profile-overlay" id="profileOverlay" onclick="closeProfile()"></div>
    <div class="profile-panel" id="profilePanel">
      <div class="profile-header">
        <span class="profile-title">Profile</span>
        <button class="profile-close" onclick="closeProfile()">√ó</button>
      </div>
      <div class="profile-content">
        <div class="profile-avatar-section">
          <div class="profile-avatar" id="profileAvatar">U</div>
          <div class="profile-user-info">
            <div class="profile-name" id="profileName">User</div>
            <div class="profile-handle">@user</div>
          </div>
        </div>
        
        <div class="profile-info-section">
          <div class="profile-info-title">Account Information</div>
          <div class="profile-info-item">
            <div class="profile-info-icon">üë§</div>
            <div class="profile-info-content">
              <div class="profile-info-label">Full Name</div>
              <div class="profile-info-value" id="infoName">User</div>
            </div>
          </div>
          <div class="profile-info-item">
            <div class="profile-info-icon">‚úâÔ∏è</div>
            <div class="profile-info-content">
              <div class="profile-info-label">Email Address</div>
              <div class="profile-info-value" id="infoEmail">user@example.com</div>
            </div>
          </div>
          <div class="profile-info-item">
            <div class="profile-info-icon">üìÖ</div>
            <div class="profile-info-content">
              <div class="profile-info-label">Member Since</div>
              <div class="profile-info-value" id="infoJoined">January 12, 2026</div>
            </div>
          </div>
        </div>

        <div class="theme-section">
          <div class="profile-info-title">Appearance</div>
          <div class="theme-toggle-row">
            <div class="theme-toggle-left">
              <div class="theme-toggle-icon">üé®</div>
              <div>
                <div class="theme-toggle-label">Theme</div>
                <div class="theme-toggle-sublabel" id="themeLabel">Dark mode</div>
              </div>
            </div>
            <div class="theme-icons">
              <span class="theme-icon-dark">üåô</span>
              <label class="theme-switch">
                <input type="checkbox" id="themeToggle" onchange="toggleTheme()">
                <span class="theme-slider"></span>
              </label>
              <span class="theme-icon-light">‚òÄÔ∏è</span>
            </div>
          </div>
        </div>

        <div class="support-section">
          <div class="support-header">
            <div class="support-icon">üí¨</div>
            <div>
              <div class="support-title">Support Chat</div>
              <div class="support-subtitle">We typically reply within minutes</div>
            </div>
          </div>
          <div class="chat-messages" id="chatMessages">
            <div class="chat-message support">
              Hi! üëã Welcome to ApeHub support. How can I help you today?
              <div class="chat-message-time">Support Team</div>
            </div>
          </div>
          <div class="chat-input-row">
            <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." onkeypress="handleChatKeypress(event)">
            <button class="chat-send" onclick="sendSupportMessage()">‚û§</button>
          </div>
        </div>

        <button class="profile-logout" onclick="handleLogout()">Sign Out</button>
      </div>
    </div>

    <!-- Indices Strip -->
    <div class="indices-section">
      <div class="indices-header">
        <span class="indices-title">Markets</span>
        <div class="market-status-badge">
          <span class="dot" id="marketDot"></span>
          <span id="marketStatusText">Closed</span>
        </div>
      </div>
      <div class="indices-scroll">
        <div class="index-item">
          <div class="index-name">S&P 500</div>
          <div class="index-value">5,918.25</div>
          <div class="index-change up">+0.87%</div>
        </div>
        <div class="index-item">
          <div class="index-name">DOW</div>
          <div class="index-value">42,840.26</div>
          <div class="index-change up">+1.24%</div>
        </div>
        <div class="index-item">
          <div class="index-name">NASDAQ</div>
          <div class="index-value">19,572.60</div>
          <div class="index-change down">-0.32%</div>
        </div>
        <div class="index-item">
          <div class="index-name">RUSSELL</div>
          <div class="index-value">2,279.45</div>
          <div class="index-change up">+1.52%</div>
        </div>
        <div class="index-item">
          <div class="index-name">NYSE</div>
          <div class="index-value">19,245.80</div>
          <div class="index-change up">+0.65%</div>
        </div>
      </div>
    </div>

    <!-- Watchlist Section -->
    <div class="watchlist-section">
      <div class="wl-header">
        <div class="wl-title-section">
          <div class="wl-list-name">Portfolio</div>
          <div class="wl-total-value" onclick="toggleValueDisplay()">
            <span class="wl-total-amount" id="watchlist-total-value">$0.00</span>
            <span class="wl-total-change" id="watchlist-change">+$0.00 (0.00%)</span>
          </div>
        </div>
        <div class="wl-header-actions">
          <button class="wl-eye-btn" id="eye-btn" onclick="toggleHideValues()">
            <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
            <svg class="eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
              <line x1="1" y1="1" x2="23" y2="23"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Search -->
      <div class="wl-search-container">
        <svg class="wl-search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="M21 21l-4.35-4.35"/>
        </svg>
        <input 
          type="text" 
          class="wl-search-input" 
          id="search-input"
          placeholder="Search stocks..."
          autocomplete="off"
        />
        <button class="wl-search-clear" id="search-clear" onclick="clearSearch()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
        
        <!-- Search Results -->
        <div class="wl-search-results" id="search-results"></div>
      </div>

      <!-- Watchlist Label with Collapse -->
      <div class="watchlist-label-row">
        <span class="watchlist-label">Watchlist</span>
        <button class="wl-collapse-btn" id="collapse-btn" onclick="toggleCollapse()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="18 15 12 9 6 15"/>
          </svg>
        </button>
      </div>

      <!-- Stock List -->
      <div class="wl-stock-list" id="watchlist-content">
        <div class="wl-empty">
          <div class="wl-empty-icon">‚≠ê</div>
          <h3>Your watchlist is empty</h3>
          <p>Search for stocks and tap the star to add them</p>
        </div>
      </div>

    </div> <!-- end watchlist-section -->

  </div>

  <!-- Bottom Nav -->
  <nav class="bottom-nav">
    <a href="dashboard.html" class="nav-item active">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 3L2 12h3v8h6v-6h2v6h6v-8h3L12 3z"/>
      </svg>
      <span>Home</span>
    </a>
    <a href="news.html" class="nav-item">
      <svg viewBox="0 0 16 16" fill="currentColor">
        <path d="M8 0C8 4.418 4.418 8 0 8C4.418 8 8 11.582 8 16C8 11.582 11.582 8 16 8C11.582 8 8 4.418 8 0Z"/>
      </svg>
      <span>News</span>
    </a>
    <a href="charts.html" class="nav-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M6 4v4M6 14v6M6 8h0M6 14h0"/>
        <rect x="4" y="8" width="4" height="6" rx="1" fill="currentColor"/>
        <path d="M12 2v6M12 12v10M12 8h0M12 12h0"/>
        <rect x="10" y="8" width="4" height="4" rx="1"/>
        <path d="M18 6v4M18 16v4M18 10h0M18 16h0"/>
        <rect x="16" y="10" width="4" height="6" rx="1" fill="currentColor"/>
      </svg>
      <span>Charts</span>
    </a>
    <a href="markets.html" class="nav-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <circle cx="12" cy="12" r="5"/>
        <ellipse cx="12" cy="12" rx="10" ry="3" transform="rotate(-20 12 12)"/>
      </svg>
      <span>Markets</span>
    </a>
    <a href="chat.html" class="nav-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2C6.48 2 2 6.48 2 12c0 1.85.5 3.58 1.36 5.08L2 22l4.92-1.36C8.42 21.5 10.15 22 12 22c5.52 0 10-4.48 10-10S17.52 2 12 2z"/>
      </svg>
      <span>Chat</span>
    </a>
  </nav>

  <!-- Toast -->
  <div class="wl-toast" id="toast"></div>

  <!-- Stock Modal -->
  <div class="modal-overlay" id="stock-modal">
    <div class="modal-content">
      <div class="modal-handle"></div>
      <div class="modal-header">
        <div class="modal-stock-info">
          <span class="modal-symbol" id="modal-symbol">AAPL</span>
          <span class="modal-name" id="modal-name">Apple Inc.</span>
        </div>
        <div class="modal-price-info">
          <div class="modal-current-price" id="modal-price">$248.13</div>
          <div class="modal-price-change up" id="modal-change">+2.34%</div>
        </div>
      </div>
      <div class="modal-form">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Total Shares</label>
            <div class="form-display" id="modal-total-shares">0</div>
          </div>
          <div class="form-group">
            <label class="form-label">Add Shares</label>
            <input type="number" class="form-input" id="modal-shares" placeholder="0" min="0" step="any">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Price Paid</label>
            <input type="number" class="form-input" id="modal-cost" placeholder="$0.00" min="0" step="0.01">
          </div>
          <div class="form-group">
            <label class="form-label">Avg Cost</label>
            <div class="form-display" id="modal-avg-cost">$0.00</div>
          </div>
        </div>
        <div class="position-summary">
          <div class="summary-row">
            <span class="summary-label">Market Value</span>
            <span class="summary-value" id="modal-market-value">$0.00</span>
          </div>
          <div class="summary-row">
            <span class="summary-label">Total Cost</span>
            <span class="summary-value" id="modal-total-cost">$0.00</span>
          </div>
          <div class="summary-row">
            <span class="summary-label">Total Return</span>
            <span class="summary-value" id="modal-return">$0.00</span>
          </div>
        </div>
        <div class="modal-buttons">
          <button class="modal-btn modal-btn-cancel" onclick="closeModal()">Cancel</button>
          <button class="modal-btn modal-btn-add" onclick="addToPosition()">Add</button>
          <button class="modal-btn modal-btn-save" onclick="savePosition()">Save</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ============================================
    // STOCK DATABASE
    // ============================================
    const stockDatabase = [
      // Tech Giants
      { symbol: 'AAPL', name: 'Apple Inc.', price: 248.13, changePercent: 2.34, trend: 'up' },
      { symbol: 'MSFT', name: 'Microsoft Corporation', price: 438.92, changePercent: -0.87, trend: 'down' },
      { symbol: 'GOOGL', name: 'Alphabet Inc.', price: 191.24, changePercent: 1.56, trend: 'up' },
      { symbol: 'GOOG', name: 'Alphabet Inc. Class C', price: 192.85, changePercent: 1.48, trend: 'up' },
      { symbol: 'AMZN', name: 'Amazon.com Inc.', price: 225.94, changePercent: 3.21, trend: 'up' },
      { symbol: 'TSLA', name: 'Tesla Inc.', price: 394.36, changePercent: -2.15, trend: 'down' },
      { symbol: 'META', name: 'Meta Platforms Inc.', price: 617.12, changePercent: 1.89, trend: 'up' },
      { symbol: 'NVDA', name: 'NVIDIA Corporation', price: 140.14, changePercent: 4.52, trend: 'up' },
      { symbol: 'AVGO', name: 'Broadcom Inc.', price: 232.45, changePercent: 2.18, trend: 'up' },
      { symbol: 'ORCL', name: 'Oracle Corporation', price: 178.32, changePercent: 1.23, trend: 'up' },
      { symbol: 'CRM', name: 'Salesforce Inc.', price: 342.18, changePercent: -0.54, trend: 'down' },
      { symbol: 'ADBE', name: 'Adobe Inc.', price: 478.92, changePercent: 0.87, trend: 'up' },
      { symbol: 'AMD', name: 'Advanced Micro Devices', price: 124.56, changePercent: 3.42, trend: 'up' },
      { symbol: 'INTC', name: 'Intel Corporation', price: 19.84, changePercent: -1.56, trend: 'down' },
      { symbol: 'QCOM', name: 'Qualcomm Inc.', price: 158.73, changePercent: 1.92, trend: 'up' },
      { symbol: 'TXN', name: 'Texas Instruments', price: 192.45, changePercent: 0.68, trend: 'up' },
      { symbol: 'IBM', name: 'IBM Corporation', price: 224.18, changePercent: 0.34, trend: 'up' },
      { symbol: 'NOW', name: 'ServiceNow Inc.', price: 1024.56, changePercent: 2.14, trend: 'up' },
      { symbol: 'INTU', name: 'Intuit Inc.', price: 628.34, changePercent: 1.45, trend: 'up' },
      { symbol: 'CSCO', name: 'Cisco Systems Inc.', price: 58.92, changePercent: 0.23, trend: 'up' },
      { symbol: 'MU', name: 'Micron Technology', price: 87.45, changePercent: 2.87, trend: 'up' },
      { symbol: 'AMAT', name: 'Applied Materials', price: 178.23, changePercent: 1.98, trend: 'up' },
      { symbol: 'LRCX', name: 'Lam Research Corp', price: 72.34, changePercent: 2.12, trend: 'up' },
      { symbol: 'KLAC', name: 'KLA Corporation', price: 678.45, changePercent: 1.76, trend: 'up' },
      { symbol: 'SNPS', name: 'Synopsys Inc.', price: 512.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'CDNS', name: 'Cadence Design Systems', price: 298.76, changePercent: 1.23, trend: 'up' },
      { symbol: 'MRVL', name: 'Marvell Technology', price: 118.45, changePercent: 3.21, trend: 'up' },
      { symbol: 'NXPI', name: 'NXP Semiconductors', price: 234.56, changePercent: 1.45, trend: 'up' },
      { symbol: 'ON', name: 'ON Semiconductor', price: 68.92, changePercent: 2.34, trend: 'up' },
      { symbol: 'MCHP', name: 'Microchip Technology', price: 58.23, changePercent: -0.87, trend: 'down' },
      
      // Financials
      { symbol: 'JPM', name: 'JPMorgan Chase & Co.', price: 252.32, changePercent: 0.76, trend: 'up' },
      { symbol: 'V', name: 'Visa Inc.', price: 318.45, changePercent: 0.45, trend: 'up' },
      { symbol: 'MA', name: 'Mastercard Inc.', price: 528.67, changePercent: 0.82, trend: 'up' },
      { symbol: 'BAC', name: 'Bank of America Corp', price: 45.23, changePercent: 2.15, trend: 'up' },
      { symbol: 'WFC', name: 'Wells Fargo & Co.', price: 72.45, changePercent: 1.23, trend: 'up' },
      { symbol: 'GS', name: 'Goldman Sachs Group', price: 612.34, changePercent: 1.87, trend: 'up' },
      { symbol: 'MS', name: 'Morgan Stanley', price: 128.45, changePercent: 1.45, trend: 'up' },
      { symbol: 'C', name: 'Citigroup Inc.', price: 78.92, changePercent: 0.98, trend: 'up' },
      { symbol: 'BLK', name: 'BlackRock Inc.', price: 1045.67, changePercent: 0.67, trend: 'up' },
      { symbol: 'SCHW', name: 'Charles Schwab Corp', price: 78.34, changePercent: 1.12, trend: 'up' },
      { symbol: 'AXP', name: 'American Express Co.', price: 298.45, changePercent: 1.34, trend: 'up' },
      { symbol: 'SPGI', name: 'S&P Global Inc.', price: 512.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'CME', name: 'CME Group Inc.', price: 228.45, changePercent: 0.34, trend: 'up' },
      { symbol: 'ICE', name: 'Intercontinental Exchange', price: 156.78, changePercent: 0.45, trend: 'up' },
      { symbol: 'PNC', name: 'PNC Financial Services', price: 198.34, changePercent: 0.87, trend: 'up' },
      { symbol: 'USB', name: 'U.S. Bancorp', price: 52.45, changePercent: 0.67, trend: 'up' },
      { symbol: 'TFC', name: 'Truist Financial Corp', price: 42.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'COF', name: 'Capital One Financial', price: 178.92, changePercent: 1.56, trend: 'up' },
      { symbol: 'BK', name: 'Bank of New York Mellon', price: 82.34, changePercent: 0.78, trend: 'up' },
      { symbol: 'AIG', name: 'American Intl Group', price: 78.45, changePercent: 0.56, trend: 'up' },
      { symbol: 'MET', name: 'MetLife Inc.', price: 82.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'PRU', name: 'Prudential Financial', price: 118.45, changePercent: 0.89, trend: 'up' },
      { symbol: 'ALL', name: 'Allstate Corporation', price: 198.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'TRV', name: 'Travelers Companies', price: 268.45, changePercent: 0.34, trend: 'up' },
      { symbol: 'CB', name: 'Chubb Limited', price: 298.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'AON', name: 'Aon plc', price: 378.45, changePercent: 0.67, trend: 'up' },
      { symbol: 'MMC', name: 'Marsh McLennan Cos', price: 228.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'PYPL', name: 'PayPal Holdings Inc.', price: 88.92, changePercent: 2.34, trend: 'up' },
      { symbol: 'SQ', name: 'Block Inc.', price: 92.45, changePercent: 3.12, trend: 'up' },
      { symbol: 'COIN', name: 'Coinbase Global Inc.', price: 278.34, changePercent: 5.67, trend: 'up' },
      { symbol: 'HOOD', name: 'Robinhood Markets', price: 42.34, changePercent: 4.23, trend: 'up' },
      { symbol: 'SOFI', name: 'SoFi Technologies', price: 16.78, changePercent: 3.45, trend: 'up' },
      
      // Healthcare
      { symbol: 'UNH', name: 'UnitedHealth Group', price: 502.34, changePercent: -1.24, trend: 'down' },
      { symbol: 'JNJ', name: 'Johnson & Johnson', price: 146.75, changePercent: 0.18, trend: 'up' },
      { symbol: 'LLY', name: 'Eli Lilly and Co.', price: 782.45, changePercent: 2.34, trend: 'up' },
      { symbol: 'PFE', name: 'Pfizer Inc.', price: 26.34, changePercent: -0.87, trend: 'down' },
      { symbol: 'ABBV', name: 'AbbVie Inc.', price: 178.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'MRK', name: 'Merck & Co. Inc.', price: 98.45, changePercent: 0.45, trend: 'up' },
      { symbol: 'TMO', name: 'Thermo Fisher Scientific', price: 512.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'ABT', name: 'Abbott Laboratories', price: 118.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'DHR', name: 'Danaher Corporation', price: 248.45, changePercent: 0.78, trend: 'up' },
      { symbol: 'BMY', name: 'Bristol-Myers Squibb', price: 52.34, changePercent: -0.34, trend: 'down' },
      { symbol: 'AMGN', name: 'Amgen Inc.', price: 268.92, changePercent: 0.89, trend: 'up' },
      { symbol: 'GILD', name: 'Gilead Sciences Inc.', price: 92.45, changePercent: 0.56, trend: 'up' },
      { symbol: 'VRTX', name: 'Vertex Pharmaceuticals', price: 428.34, changePercent: 1.45, trend: 'up' },
      { symbol: 'REGN', name: 'Regeneron Pharma', price: 712.45, changePercent: 0.67, trend: 'up' },
      { symbol: 'ISRG', name: 'Intuitive Surgical', price: 578.34, changePercent: 1.89, trend: 'up' },
      { symbol: 'MDT', name: 'Medtronic plc', price: 88.92, changePercent: 0.34, trend: 'up' },
      { symbol: 'SYK', name: 'Stryker Corporation', price: 398.45, changePercent: 0.78, trend: 'up' },
      { symbol: 'BSX', name: 'Boston Scientific Corp', price: 92.34, changePercent: 1.12, trend: 'up' },
      { symbol: 'ELV', name: 'Elevance Health Inc.', price: 412.45, changePercent: -0.56, trend: 'down' },
      { symbol: 'CI', name: 'Cigna Group', price: 298.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'HUM', name: 'Humana Inc.', price: 278.92, changePercent: -0.89, trend: 'down' },
      { symbol: 'CVS', name: 'CVS Health Corp.', price: 52.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'MCK', name: 'McKesson Corporation', price: 578.45, changePercent: 0.67, trend: 'up' },
      { symbol: 'ZTS', name: 'Zoetis Inc.', price: 168.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'MRNA', name: 'Moderna Inc.', price: 42.45, changePercent: 4.56, trend: 'up' },
      { symbol: 'BIIB', name: 'Biogen Inc.', price: 158.34, changePercent: 1.23, trend: 'up' },
      
      // Consumer
      { symbol: 'WMT', name: 'Walmart Inc.', price: 92.18, changePercent: -0.32, trend: 'down' },
      { symbol: 'PG', name: 'Procter & Gamble Co.', price: 168.92, changePercent: 0.62, trend: 'up' },
      { symbol: 'KO', name: 'Coca-Cola Company', price: 62.45, changePercent: 0.34, trend: 'up' },
      { symbol: 'PEP', name: 'PepsiCo Inc.', price: 148.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'COST', name: 'Costco Wholesale Corp', price: 978.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'HD', name: 'Home Depot Inc.', price: 412.56, changePercent: 1.87, trend: 'up' },
      { symbol: 'MCD', name: 'McDonald\'s Corporation', price: 298.45, changePercent: 0.67, trend: 'up' },
      { symbol: 'NKE', name: 'Nike Inc.', price: 72.34, changePercent: -1.23, trend: 'down' },
      { symbol: 'SBUX', name: 'Starbucks Corporation', price: 112.45, changePercent: 0.89, trend: 'up' },
      { symbol: 'DIS', name: 'Walt Disney Company', price: 118.92, changePercent: 1.45, trend: 'up' },
      { symbol: 'NFLX', name: 'Netflix Inc.', price: 912.34, changePercent: 2.34, trend: 'up' },
      { symbol: 'CMCSA', name: 'Comcast Corporation', price: 42.45, changePercent: 0.56, trend: 'up' },
      { symbol: 'T', name: 'AT&T Inc.', price: 22.34, changePercent: 0.34, trend: 'up' },
      { symbol: 'VZ', name: 'Verizon Communications', price: 42.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'TMUS', name: 'T-Mobile US Inc.', price: 248.34, changePercent: 0.78, trend: 'up' },
      { symbol: 'LOW', name: 'Lowe\'s Companies Inc.', price: 268.45, changePercent: 1.12, trend: 'up' },
      { symbol: 'TGT', name: 'Target Corporation', price: 128.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'TJX', name: 'TJX Companies Inc.', price: 122.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'BKNG', name: 'Booking Holdings Inc.', price: 5124.56, changePercent: 1.56, trend: 'up' },
      { symbol: 'MAR', name: 'Marriott International', price: 278.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'HLT', name: 'Hilton Worldwide', price: 258.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'ABNB', name: 'Airbnb Inc.', price: 142.45, changePercent: 2.34, trend: 'up' },
      { symbol: 'UBER', name: 'Uber Technologies', price: 68.92, changePercent: 1.89, trend: 'up' },
      { symbol: 'LYFT', name: 'Lyft Inc.', price: 14.56, changePercent: 2.45, trend: 'up' },
      { symbol: 'DASH', name: 'DoorDash Inc.', price: 178.34, changePercent: 3.12, trend: 'up' },
      { symbol: 'SPOT', name: 'Spotify Technology', price: 498.92, changePercent: 2.67, trend: 'up' },
      { symbol: 'ROKU', name: 'Roku Inc.', price: 82.34, changePercent: 3.45, trend: 'up' },
      { symbol: 'GM', name: 'General Motors Co.', price: 52.45, changePercent: 1.23, trend: 'up' },
      { symbol: 'F', name: 'Ford Motor Company', price: 10.92, changePercent: 0.89, trend: 'up' },
      { symbol: 'RIVN', name: 'Rivian Automotive', price: 12.34, changePercent: 4.56, trend: 'up' },
      { symbol: 'LCID', name: 'Lucid Group Inc.', price: 2.45, changePercent: 3.78, trend: 'up' },
      { symbol: 'YUM', name: 'Yum! Brands Inc.', price: 138.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'CMG', name: 'Chipotle Mexican Grill', price: 62.34, changePercent: 1.45, trend: 'up' },
      { symbol: 'DPZ', name: 'Domino\'s Pizza Inc.', price: 478.92, changePercent: 0.89, trend: 'up' },
      { symbol: 'LULU', name: 'Lululemon Athletica', price: 398.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'ROST', name: 'Ross Stores Inc.', price: 158.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'DG', name: 'Dollar General Corp', price: 78.34, changePercent: -0.89, trend: 'down' },
      { symbol: 'DLTR', name: 'Dollar Tree Inc.', price: 68.92, changePercent: -0.56, trend: 'down' },
      { symbol: 'EL', name: 'Est√©e Lauder Cos', price: 68.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'CL', name: 'Colgate-Palmolive Co.', price: 98.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'KMB', name: 'Kimberly-Clark Corp', price: 138.34, changePercent: 0.34, trend: 'up' },
      { symbol: 'GIS', name: 'General Mills Inc.', price: 62.92, changePercent: 0.23, trend: 'up' },
      { symbol: 'K', name: 'Kellanova', price: 82.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'HSY', name: 'Hershey Company', price: 168.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'MDLZ', name: 'Mondelez International', price: 68.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'KHC', name: 'Kraft Heinz Company', price: 32.92, changePercent: 0.34, trend: 'up' },
      { symbol: 'STZ', name: 'Constellation Brands', price: 228.34, changePercent: 0.78, trend: 'up' },
      { symbol: 'TAP', name: 'Molson Coors Beverage', price: 58.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'BUD', name: 'Anheuser-Busch InBev', price: 52.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'DEO', name: 'Diageo plc', price: 118.92, changePercent: 0.34, trend: 'up' },
      { symbol: 'PM', name: 'Philip Morris Intl', price: 128.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'MO', name: 'Altria Group Inc.', price: 52.92, changePercent: 0.45, trend: 'up' },
      
      // Industrials
      { symbol: 'CAT', name: 'Caterpillar Inc.', price: 398.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'DE', name: 'Deere & Company', price: 478.92, changePercent: 0.89, trend: 'up' },
      { symbol: 'BA', name: 'Boeing Company', price: 178.34, changePercent: -2.34, trend: 'down' },
      { symbol: 'HON', name: 'Honeywell International', price: 228.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'UNP', name: 'Union Pacific Corp', price: 248.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'RTX', name: 'RTX Corporation', price: 128.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'LMT', name: 'Lockheed Martin Corp', price: 512.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'GE', name: 'GE Aerospace', price: 192.92, changePercent: 1.56, trend: 'up' },
      { symbol: 'MMM', name: '3M Company', price: 138.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'UPS', name: 'United Parcel Service', price: 128.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'FDX', name: 'FedEx Corporation', price: 278.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'GD', name: 'General Dynamics Corp', price: 298.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'NOC', name: 'Northrop Grumman Corp', price: 478.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'WM', name: 'Waste Management Inc.', price: 228.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'RSG', name: 'Republic Services Inc.', price: 218.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'CSX', name: 'CSX Corporation', price: 38.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'NSC', name: 'Norfolk Southern Corp', price: 268.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'EMR', name: 'Emerson Electric Co.', price: 128.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'ETN', name: 'Eaton Corporation plc', price: 348.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'ITW', name: 'Illinois Tool Works', price: 268.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'PH', name: 'Parker-Hannifin Corp', price: 678.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'ROK', name: 'Rockwell Automation', price: 278.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'CMI', name: 'Cummins Inc.', price: 368.34, changePercent: 0.78, trend: 'up' },
      { symbol: 'PCAR', name: 'PACCAR Inc.', price: 108.92, changePercent: 0.89, trend: 'up' },
      { symbol: 'DAL', name: 'Delta Air Lines Inc.', price: 62.34, changePercent: 1.45, trend: 'up' },
      { symbol: 'UAL', name: 'United Airlines Holdings', price: 108.92, changePercent: 1.67, trend: 'up' },
      { symbol: 'AAL', name: 'American Airlines Group', price: 18.34, changePercent: 2.34, trend: 'up' },
      { symbol: 'LUV', name: 'Southwest Airlines Co.', price: 38.92, changePercent: 1.23, trend: 'up' },
      
      // Energy
      { symbol: 'XOM', name: 'Exxon Mobil Corp', price: 108.34, changePercent: 0.78, trend: 'up' },
      { symbol: 'CVX', name: 'Chevron Corporation', price: 148.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'COP', name: 'ConocoPhillips', price: 98.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'SLB', name: 'Schlumberger Limited', price: 42.92, changePercent: 1.23, trend: 'up' },
      { symbol: 'EOG', name: 'EOG Resources Inc.', price: 128.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'PXD', name: 'Pioneer Natural Resources', price: 228.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'MPC', name: 'Marathon Petroleum', price: 158.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'VLO', name: 'Valero Energy Corp', price: 138.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'PSX', name: 'Phillips 66', price: 128.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'OXY', name: 'Occidental Petroleum', price: 48.92, changePercent: 1.45, trend: 'up' },
      { symbol: 'HAL', name: 'Halliburton Company', price: 28.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'BKR', name: 'Baker Hughes Company', price: 42.92, changePercent: 0.89, trend: 'up' },
      { symbol: 'DVN', name: 'Devon Energy Corp', price: 38.34, changePercent: 1.12, trend: 'up' },
      { symbol: 'FANG', name: 'Diamondback Energy', price: 178.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'HES', name: 'Hess Corporation', price: 148.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'KMI', name: 'Kinder Morgan Inc.', price: 28.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'WMB', name: 'Williams Companies', price: 58.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'OKE', name: 'ONEOK Inc.', price: 98.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'ENPH', name: 'Enphase Energy Inc.', price: 68.34, changePercent: 3.45, trend: 'up' },
      { symbol: 'FSLR', name: 'First Solar Inc.', price: 198.92, changePercent: 2.34, trend: 'up' },
      
      // Utilities & Real Estate
      { symbol: 'NEE', name: 'NextEra Energy Inc.', price: 78.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'DUK', name: 'Duke Energy Corp', price: 112.92, changePercent: 0.34, trend: 'up' },
      { symbol: 'SO', name: 'Southern Company', price: 88.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'D', name: 'Dominion Energy Inc.', price: 58.92, changePercent: 0.34, trend: 'up' },
      { symbol: 'AEP', name: 'American Electric Power', price: 98.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'SRE', name: 'Sempra Energy', price: 88.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'XEL', name: 'Xcel Energy Inc.', price: 68.34, changePercent: 0.34, trend: 'up' },
      { symbol: 'EXC', name: 'Exelon Corporation', price: 42.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'PEG', name: 'Public Service Enterprise', price: 88.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'ED', name: 'Consolidated Edison', price: 98.92, changePercent: 0.34, trend: 'up' },
      { symbol: 'AWK', name: 'American Water Works', price: 128.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'AMT', name: 'American Tower Corp', price: 198.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'CCI', name: 'Crown Castle Inc.', price: 98.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'PLD', name: 'Prologis Inc.', price: 118.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'EQIX', name: 'Equinix Inc.', price: 978.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'SPG', name: 'Simon Property Group', price: 168.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'O', name: 'Realty Income Corp', price: 58.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'WELL', name: 'Welltower Inc.', price: 138.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'AVB', name: 'AvalonBay Communities', price: 228.34, changePercent: 0.67, trend: 'up' },
      { symbol: 'EQR', name: 'Equity Residential', price: 72.92, changePercent: 0.45, trend: 'up' },
      { symbol: 'DLR', name: 'Digital Realty Trust', price: 178.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'PSA', name: 'Public Storage', price: 338.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'VICI', name: 'VICI Properties Inc.', price: 32.34, changePercent: 0.67, trend: 'up' },
      
      // Materials
      { symbol: 'LIN', name: 'Linde plc', price: 458.34, changePercent: 0.78, trend: 'up' },
      { symbol: 'APD', name: 'Air Products & Chemicals', price: 298.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'SHW', name: 'Sherwin-Williams Co.', price: 348.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'ECL', name: 'Ecolab Inc.', price: 248.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'FCX', name: 'Freeport-McMoRan Inc.', price: 42.34, changePercent: 2.34, trend: 'up' },
      { symbol: 'NEM', name: 'Newmont Corporation', price: 42.92, changePercent: 1.56, trend: 'up' },
      { symbol: 'NUE', name: 'Nucor Corporation', price: 148.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'STLD', name: 'Steel Dynamics Inc.', price: 128.92, changePercent: 1.45, trend: 'up' },
      { symbol: 'DOW', name: 'Dow Inc.', price: 48.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'DD', name: 'DuPont de Nemours', price: 78.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'PPG', name: 'PPG Industries Inc.', price: 128.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'VMC', name: 'Vulcan Materials Co.', price: 278.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'MLM', name: 'Martin Marietta Materials', price: 598.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'GOLD', name: 'Barrick Gold Corp', price: 18.92, changePercent: 1.67, trend: 'up' },
      { symbol: 'AEM', name: 'Agnico Eagle Mines', price: 88.34, changePercent: 1.45, trend: 'up' },
      
      // Other Notable
      { symbol: 'BRK.B', name: 'Berkshire Hathaway B', price: 478.34, changePercent: 0.56, trend: 'up' },
      { symbol: 'SPY', name: 'SPDR S&P 500 ETF', price: 608.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'QQQ', name: 'Invesco QQQ Trust', price: 528.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'IWM', name: 'iShares Russell 2000', price: 228.92, changePercent: 0.89, trend: 'up' },
      { symbol: 'DIA', name: 'SPDR Dow Jones ETF', price: 438.34, changePercent: 0.45, trend: 'up' },
      { symbol: 'VTI', name: 'Vanguard Total Stock', price: 298.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'VOO', name: 'Vanguard S&P 500 ETF', price: 558.34, changePercent: 0.78, trend: 'up' },
      { symbol: 'ARKK', name: 'ARK Innovation ETF', price: 58.92, changePercent: 2.34, trend: 'up' },
      { symbol: 'XLF', name: 'Financial Select SPDR', price: 48.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'XLE', name: 'Energy Select SPDR', price: 88.92, changePercent: 0.67, trend: 'up' },
      { symbol: 'XLK', name: 'Technology Select SPDR', price: 238.34, changePercent: 1.12, trend: 'up' },
      { symbol: 'XLV', name: 'Health Care Select SPDR', price: 148.92, changePercent: 0.56, trend: 'up' },
      { symbol: 'PLTR', name: 'Palantir Technologies', price: 78.34, changePercent: 4.56, trend: 'up' },
      { symbol: 'SNOW', name: 'Snowflake Inc.', price: 178.92, changePercent: 2.34, trend: 'up' },
      { symbol: 'DDOG', name: 'Datadog Inc.', price: 138.34, changePercent: 1.89, trend: 'up' },
      { symbol: 'NET', name: 'Cloudflare Inc.', price: 118.92, changePercent: 2.45, trend: 'up' },
      { symbol: 'CRWD', name: 'CrowdStrike Holdings', price: 358.34, changePercent: 1.67, trend: 'up' },
      { symbol: 'ZS', name: 'Zscaler Inc.', price: 198.92, changePercent: 1.45, trend: 'up' },
      { symbol: 'PANW', name: 'Palo Alto Networks', price: 188.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'FTNT', name: 'Fortinet Inc.', price: 98.92, changePercent: 1.56, trend: 'up' },
      { symbol: 'WDAY', name: 'Workday Inc.', price: 268.34, changePercent: 0.89, trend: 'up' },
      { symbol: 'VEEV', name: 'Veeva Systems Inc.', price: 218.92, changePercent: 0.78, trend: 'up' },
      { symbol: 'TTD', name: 'Trade Desk Inc.', price: 128.34, changePercent: 2.12, trend: 'up' },
      { symbol: 'TEAM', name: 'Atlassian Corporation', price: 258.92, changePercent: 1.34, trend: 'up' },
      { symbol: 'SHOP', name: 'Shopify Inc.', price: 112.34, changePercent: 2.67, trend: 'up' },
      { symbol: 'SQ', name: 'Block Inc.', price: 92.45, changePercent: 3.12, trend: 'up' },
      { symbol: 'MELI', name: 'MercadoLibre Inc.', price: 2078.34, changePercent: 1.89, trend: 'up' },
      { symbol: 'SE', name: 'Sea Limited', price: 118.92, changePercent: 3.45, trend: 'up' },
      { symbol: 'ZM', name: 'Zoom Video Comms', price: 78.34, changePercent: 1.23, trend: 'up' },
      { symbol: 'DOCU', name: 'DocuSign Inc.', price: 88.92, changePercent: 1.56, trend: 'up' },
      { symbol: 'OKTA', name: 'Okta Inc.', price: 98.34, changePercent: 1.78, trend: 'up' },
      { symbol: 'MDB', name: 'MongoDB Inc.', price: 268.92, changePercent: 2.34, trend: 'up' },
      { symbol: 'TWLO', name: 'Twilio Inc.', price: 118.34, changePercent: 2.12, trend: 'up' },
      { symbol: 'U', name: 'Unity Software Inc.', price: 28.92, changePercent: 3.56, trend: 'up' },
      { symbol: 'RBLX', name: 'Roblox Corporation', price: 58.34, changePercent: 4.23, trend: 'up' },
      { symbol: 'SNAP', name: 'Snap Inc.', price: 12.92, changePercent: 2.89, trend: 'up' },
      { symbol: 'PINS', name: 'Pinterest Inc.', price: 38.34, changePercent: 1.67, trend: 'up' },
      { symbol: 'ETSY', name: 'Etsy Inc.', price: 58.92, changePercent: 1.45, trend: 'up' },
      { symbol: 'W', name: 'Wayfair Inc.', price: 48.34, changePercent: 2.34, trend: 'up' },
      { symbol: 'CHWY', name: 'Chewy Inc.', price: 32.92, changePercent: 1.89, trend: 'up' },
      { symbol: 'PATH', name: 'UiPath Inc.', price: 14.34, changePercent: 2.12, trend: 'up' },
      { symbol: 'AI', name: 'C3.ai Inc.', price: 38.92, changePercent: 4.56, trend: 'up' },
      { symbol: 'SMCI', name: 'Super Micro Computer', price: 38.34, changePercent: 5.67, trend: 'up' },
      { symbol: 'ARM', name: 'Arm Holdings plc', price: 168.92, changePercent: 3.45, trend: 'up' },
      { symbol: 'IONQ', name: 'IonQ Inc.', price: 48.34, changePercent: 6.78, trend: 'up' },
      { symbol: 'RGTI', name: 'Rigetti Computing', price: 18.92, changePercent: 8.45, trend: 'up' },
    ];

    let watchlist = JSON.parse(localStorage.getItem('watchlist')) || [];
    let positions = JSON.parse(localStorage.getItem('positions')) || {};
    let currentEditSymbol = null;
    let priceCache = {};
    let lastPriceUpdate = 0;
    const PRICE_CACHE_DURATION = 60000; // 1 minute cache
    
    // Mark prices as needing update (set to 0 so API updates them)
    watchlist.forEach(stock => {
      stock.needsUpdate = true;
    });

    // ============================================
    // FINNHUB API SERVICE
    // ============================================
    const FINNHUB_API_KEY = 'd5c3ijpr01qsbmgib7u0d5c3ijpr01qsbmgib7ug';
    const FINNHUB_BASE_URL = 'https://finnhub.io/api/v1';
    
    const StockAPI = {
      async getQuote(symbol) {
        try {
          const url = `${FINNHUB_BASE_URL}/quote?symbol=${symbol}&token=${FINNHUB_API_KEY}`;
          const response = await fetch(url);
          if (!response.ok) throw new Error(`HTTP ${response.status}`);
          const data = await response.json();
          
          // Finnhub returns c=0, h=0 for invalid symbols
          if (data.c === 0 && data.h === 0) return null;
          
          return {
            symbol: symbol,
            price: data.c,           // Current price
            change: data.d,          // Change
            changePercent: data.dp,  // Change percent
            previousClose: data.pc,  // Previous close
            high: data.h,
            low: data.l,
            open: data.o,
            trend: data.dp >= 0 ? 'up' : 'down'
          };
        } catch (error) {
          console.error(`Error fetching ${symbol}:`, error);
          return null;
        }
      },
      
      async getMultipleQuotes(symbols) {
        // Finnhub requires individual requests, so we batch with delays
        const results = [];
        for (let i = 0; i < symbols.length; i++) {
          // Add small delay between requests to avoid rate limiting
          if (i > 0) await new Promise(r => setTimeout(r, 100));
          try {
            const quote = await this.getQuote(symbols[i]);
            if (quote) results.push(quote);
          } catch (error) {
            console.error(`Error fetching ${symbols[i]}:`, error);
          }
        }
        return results;
      },
      
      async search(query) {
        try {
          const url = `${FINNHUB_BASE_URL}/search?q=${encodeURIComponent(query)}&token=${FINNHUB_API_KEY}`;
          const response = await fetch(url);
          const data = await response.json();
          
          if (data.result && data.result.length > 0) {
            return data.result
              .filter(r => r.type === 'Common Stock' && !r.symbol.includes('.'))
              .slice(0, 10)
              .map(r => ({
                symbol: r.symbol,
                name: r.description
              }));
          }
          return [];
        } catch (error) {
          console.error('Search error:', error);
          return [];
        }
      }
    };

    // ============================================
    // UPDATE INDICES WITH REAL DATA
    // ============================================
    async function updateIndices() {
      // Use ETFs instead of index symbols (Finnhub doesn't support ^GSPC etc)
      const indexSymbols = ['SPY', 'DIA', 'QQQ', 'IWM', 'VTI'];
      const indexNames = ['S&P 500', 'DOW', 'NASDAQ', 'RUSSELL', 'TOTAL MKT'];
      
      try {
        const quotes = await StockAPI.getMultipleQuotes(indexSymbols);
        const indicesScroll = document.querySelector('.indices-scroll');
        
        if (quotes.length > 0 && indicesScroll) {
          indicesScroll.innerHTML = quotes.map((q, i) => {
            const isUp = q.changePercent >= 0;
            const displayValue = q.price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            const changeStr = (isUp ? '+' : '') + q.changePercent.toFixed(2) + '%';
            
            return `
              <div class="index-item">
                <div class="index-name">${indexNames[i] || q.symbol}</div>
                <div class="index-value">${displayValue}</div>
                <div class="index-change ${isUp ? 'up' : 'down'}">${changeStr}</div>
              </div>
            `;
          }).join('');
        }
      } catch (error) {
        console.error('Error updating indices:', error);
      }
    }

    // ============================================
    // UPDATE WATCHLIST WITH REAL PRICES
    // ============================================
    async function updateWatchlistPrices(force = false) {
      if (watchlist.length === 0) return;
      
      const now = Date.now();
      if (!force && now - lastPriceUpdate < PRICE_CACHE_DURATION) return;
      
      const symbols = watchlist.map(s => s.symbol);
      console.log('Fetching prices for:', symbols);
      
      try {
        const quotes = await StockAPI.getMultipleQuotes(symbols);
        console.log('Received quotes:', quotes);
        
        if (quotes.length === 0) {
          console.warn('No quotes received from API');
          return;
        }
        
        quotes.forEach(q => {
          if (q.price > 0) {
            priceCache[q.symbol] = {
              price: q.price,
              changePercent: q.changePercent,
              trend: q.trend,
              timestamp: now
            };
            
            // Update watchlist item
            const idx = watchlist.findIndex(s => s.symbol === q.symbol);
            if (idx !== -1) {
              watchlist[idx].price = q.price;
              watchlist[idx].changePercent = q.changePercent;
              watchlist[idx].trend = q.trend;
            }
          }
        });
        
        lastPriceUpdate = now;
        localStorage.setItem('watchlist', JSON.stringify(watchlist));
        renderWatchlist();
        console.log('Watchlist updated with live prices');
      } catch (error) {
        console.error('Error updating watchlist prices:', error);
      }
    }

    // ============================================
    // UPDATE STOCK DATABASE WITH REAL PRICES (for search)
    // ============================================
    async function updateSearchResultPrices(symbols) {
      if (symbols.length === 0) return;
      
      try {
        const quotes = await StockAPI.getMultipleQuotes(symbols);
        
        quotes.forEach(q => {
          const idx = stockDatabase.findIndex(s => s.symbol === q.symbol);
          if (idx !== -1) {
            stockDatabase[idx].price = q.price;
            stockDatabase[idx].changePercent = q.changePercent;
            stockDatabase[idx].trend = q.trend;
          }
        });
      } catch (error) {
        console.error('Error updating search prices:', error);
      }
    }

    // ============================================
    // MODAL FUNCTIONS
    // ============================================
    function openModal(symbol) {
      const stock = watchlist.find(s => s.symbol === symbol) || stockDatabase.find(s => s.symbol === symbol);
      if (!stock) return;
      
      currentEditSymbol = symbol;
      const position = positions[symbol] || { shares: 0, avgCost: 0 };
      const isUp = stock.changePercent >= 0;
      
      document.getElementById('modal-symbol').textContent = stock.symbol;
      document.getElementById('modal-name').textContent = stock.name;
      document.getElementById('modal-price').textContent = '$' + stock.price.toFixed(2);
      
      const changeEl = document.getElementById('modal-change');
      changeEl.textContent = (isUp ? '+' : '') + stock.changePercent.toFixed(2) + '%';
      changeEl.className = 'modal-price-change ' + (isUp ? 'up' : 'down');
      
      // Show current total shares, clear input for adding new shares
      document.getElementById('modal-total-shares').textContent = position.shares || 0;
      document.getElementById('modal-shares').value = '';
      document.getElementById('modal-cost').value = '';
      document.getElementById('modal-avg-cost').textContent = '$' + (position.avgCost || 0).toFixed(2);
      
      updateModalCalculations();
      
      document.getElementById('stock-modal').classList.add('visible');
    }

    function closeModal() {
      document.getElementById('stock-modal').classList.remove('visible');
      currentEditSymbol = null;
    }

    function updateModalCalculations() {
      const existingShares = parseFloat(document.getElementById('modal-total-shares').textContent) || 0;
      const addShares = parseFloat(document.getElementById('modal-shares').value) || 0;
      const newCost = parseFloat(document.getElementById('modal-cost').value) || 0;
      const stock = stockDatabase.find(s => s.symbol === currentEditSymbol);
      const existing = positions[currentEditSymbol] || { shares: 0, avgCost: 0 };
      
      if (!stock) return;
      
      // Calculate with existing + new shares
      const totalShares = existingShares + addShares;
      const totalCostValue = (existing.shares * existing.avgCost) + (addShares * newCost);
      const newAvgCost = totalShares > 0 ? totalCostValue / totalShares : existing.avgCost;
      const marketValue = totalShares * stock.price;
      const totalReturn = marketValue - totalCostValue;
      const isGain = totalReturn >= 0;
      
      // Update avg cost display
      document.getElementById('modal-avg-cost').textContent = '$' + newAvgCost.toFixed(2);
      
      document.getElementById('modal-market-value').textContent = '$' + marketValue.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      document.getElementById('modal-total-cost').textContent = '$' + totalCostValue.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      
      const returnEl = document.getElementById('modal-return');
      returnEl.textContent = (isGain ? '+' : '') + '$' + totalReturn.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      returnEl.className = 'summary-value ' + (isGain ? 'gain' : 'loss');
    }

    function savePosition() {
      const existingShares = parseFloat(document.getElementById('modal-total-shares').textContent) || 0;
      const addShares = parseFloat(document.getElementById('modal-shares').value) || 0;
      const newCost = parseFloat(document.getElementById('modal-cost').value) || 0;
      const existing = positions[currentEditSymbol] || { shares: 0, avgCost: 0 };
      
      const totalShares = existingShares + addShares;
      const totalCostValue = (existing.shares * existing.avgCost) + (addShares * newCost);
      const avgCost = totalShares > 0 ? totalCostValue / totalShares : 0;
      
      if (totalShares > 0) {
        positions[currentEditSymbol] = { shares: totalShares, avgCost: avgCost };
        // Trigger confetti celebration!
        triggerConfetti();
      } else {
        delete positions[currentEditSymbol];
      }
      
      localStorage.setItem('positions', JSON.stringify(positions));
      closeModal();
      renderWatchlist();
      showToast('Position saved', 'success');
    }

    // Confetti celebration function (Robinhood-style)
    function triggerConfetti() {
      const container = document.createElement('div');
      container.className = 'confetti-container';
      document.body.appendChild(container);

      const colors = ['#a855f7', '#00d775', '#ff4757', '#ffd700', '#00bfff', '#ff69b4', '#7c3aed'];
      const shapes = ['square', 'circle', 'strip'];
      const confettiCount = 150;

      for (let i = 0; i < confettiCount; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti ' + shapes[Math.floor(Math.random() * shapes.length)];
        
        // Random properties
        const left = Math.random() * 100;
        const delay = Math.random() * 0.5;
        const duration = 2 + Math.random() * 2;
        const size = 6 + Math.random() * 8;
        const color = colors[Math.floor(Math.random() * colors.length)];
        
        confetti.style.left = left + '%';
        confetti.style.backgroundColor = color;
        confetti.style.width = size + 'px';
        confetti.style.height = size + 'px';
        confetti.style.animationDelay = delay + 's';
        confetti.style.animationDuration = duration + 's';
        
        container.appendChild(confetti);
      }

      // Remove container after animation completes
      setTimeout(() => {
        container.remove();
      }, 4500);
    }

    // Add to existing position (averages cost)
    function addToPosition() {
      const newShares = parseFloat(document.getElementById('modal-shares').value) || 0;
      const newCost = parseFloat(document.getElementById('modal-cost').value) || 0;
      
      if (newShares <= 0) {
        showToast('Enter shares to add', 'removed');
        return;
      }
      
      const existing = positions[currentEditSymbol] || { shares: 0, avgCost: 0 };
      const totalShares = existing.shares + newShares;
      const totalCost = (existing.shares * existing.avgCost) + (newShares * newCost);
      const avgCost = totalShares > 0 ? totalCost / totalShares : 0;
      
      positions[currentEditSymbol] = { shares: totalShares, avgCost: avgCost };
      
      localStorage.setItem('positions', JSON.stringify(positions));
      
      // Update the display and clear input for adding more
      document.getElementById('modal-total-shares').textContent = totalShares;
      document.getElementById('modal-shares').value = '';
      document.getElementById('modal-cost').value = '';
      document.getElementById('modal-avg-cost').textContent = '$' + avgCost.toFixed(2);
      updateModalCalculations();
      
      // Trigger confetti celebration!
      triggerConfetti();
      
      renderWatchlist();
      showToast(`Added ${newShares} shares`, 'success');
    }

    // Modal input listeners
    document.getElementById('modal-shares').addEventListener('input', updateModalCalculations);
    document.getElementById('modal-cost').addEventListener('input', updateModalCalculations);

    // Close modal on overlay click
    document.getElementById('stock-modal').addEventListener('click', (e) => {
      if (e.target.id === 'stock-modal') {
        closeModal();
      }
    });

    // ============================================
    // SPARKLINE GENERATOR
    // ============================================
    function generateSparkline(trend, width = 80, height = 30) {
      const points = [];
      const numPoints = 25;
      let value = 50;
      
      for (let i = 0; i < numPoints; i++) {
        const trendBias = trend === 'up' ? 0.5 : -0.5;
        value += (Math.random() - 0.5 + trendBias) * 5;
        value = Math.max(10, Math.min(90, value));
        points.push({ x: (i / (numPoints - 1)) * width, y: height - (value / 100) * height });
      }
      
      const pathData = points.map((p, i) => (i === 0 ? `M ${p.x},${p.y}` : `L ${p.x},${p.y}`)).join(' ');
      const color = trend === 'up' ? '#00d775' : '#ff4757';
      
      return `
        <svg width="${width}" height="${height}" viewBox="0 0 ${width} ${height}">
          <defs>
            <linearGradient id="grad-${trend}-${Math.random()}" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" style="stop-color:${color};stop-opacity:0.3" />
              <stop offset="100%" style="stop-color:${color};stop-opacity:0" />
            </linearGradient>
          </defs>
          <path d="${pathData} L ${width},${height} L 0,${height} Z" fill="url(#grad-${trend}-${Math.random()})" opacity="0.5"/>
          <path d="${pathData}" fill="none" stroke="${color}" stroke-width="1.5" stroke-linecap="round"/>
          <circle cx="${points[points.length-1].x}" cy="${points[points.length-1].y}" r="2.5" fill="${color}"/>
        </svg>
      `;
    }

    // ============================================
    // CLOCK & MARKET STATUS
    // ============================================
    function updateClock() {
      const now = new Date();
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const seconds = now.getSeconds();
      
      const hours12 = hours % 12 || 12;
      const period = hours < 12 ? 'AM' : 'PM';
      
      const timeString = `${hours12}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      
      document.getElementById('currentTime').textContent = timeString;
      document.getElementById('timePeriod').textContent = period;
      
      updateMarketStatus(now);
    }

    function updateMarketStatus(now) {
      const day = now.getDay();
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const currentMinutes = hours * 60 + minutes;
      
      const marketOpen = 9 * 60 + 30;
      const marketClose = 16 * 60;
      
      const statusDot = document.getElementById('statusDot');
      const statusText = document.getElementById('statusText');
      const countdown = document.getElementById('countdown');
      const countdownLabel = document.getElementById('countdownLabel');
      const marketDot = document.getElementById('marketDot');
      const marketStatusText = document.getElementById('marketStatusText');
      
      if (day === 0 || day === 6) {
        statusDot.className = 'status-dot closed';
        statusText.textContent = 'Weekend';
        if (marketDot) marketDot.style.background = '#ff4757';
        marketStatusText.textContent = 'Closed';
        
        const daysUntilMonday = day === 0 ? 1 : 2;
        const targetTime = new Date(now);
        targetTime.setDate(targetTime.getDate() + daysUntilMonday);
        targetTime.setHours(9, 30, 0, 0);
        
        const diff = targetTime - now;
        countdown.textContent = formatCountdown(diff);
        countdownLabel.textContent = 'until Monday';
        return;
      }
      
      if (currentMinutes >= marketOpen && currentMinutes < marketClose) {
        statusDot.className = 'status-dot open';
        statusText.textContent = 'Open';
        if (marketDot) marketDot.style.background = '#00d775';
        marketStatusText.textContent = 'Open';
        
        const closeTime = new Date(now);
        closeTime.setHours(16, 0, 0, 0);
        const diff = closeTime - now;
        countdown.textContent = formatCountdown(diff);
        countdownLabel.textContent = 'until close';
        
        // Red for last 10 minutes before close (3:50pm - 4:00pm)
        const minutesUntilClose = (marketClose - currentMinutes);
        if (minutesUntilClose <= 10) {
          countdown.className = 'countdown closing';
        } else {
          countdown.className = 'countdown';
        }
      } else {
        statusDot.className = 'status-dot closed';
        statusText.textContent = 'Closed';
        if (marketDot) marketDot.style.background = '#ff4757';
        marketStatusText.textContent = 'Closed';
        
        const openTime = new Date(now);
        if (currentMinutes >= marketClose) {
          openTime.setDate(openTime.getDate() + 1);
        }
        openTime.setHours(9, 30, 0, 0);
        
        while (openTime.getDay() === 0 || openTime.getDay() === 6) {
          openTime.setDate(openTime.getDate() + 1);
        }
        
        const diff = openTime - now;
        countdown.textContent = formatCountdown(diff);
        countdownLabel.textContent = 'until open';
        
        // Green for last 10 minutes before open (9:20am - 9:30am)
        const minutesUntilOpen = diff / 1000 / 60;
        if (minutesUntilOpen <= 10 && minutesUntilOpen > 0) {
          countdown.className = 'countdown opening';
        } else {
          countdown.className = 'countdown';
        }
      }
    }

    function formatCountdown(ms) {
      if (ms < 0) return '00:00:00';
      
      const totalSeconds = Math.floor(ms / 1000);
      const hours = Math.floor(totalSeconds / 3600);
      const minutes = Math.floor((totalSeconds % 3600) / 60);
      const seconds = totalSeconds % 60;
      
      return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    // ============================================
    // SEARCH
    // ============================================
    const searchInput = document.getElementById('search-input');
    const searchResults = document.getElementById('search-results');
    const searchClear = document.getElementById('search-clear');

    searchInput.addEventListener('focus', () => {
      showSearchResults(stockDatabase);
    });

    searchInput.addEventListener('input', (e) => {
      const query = e.target.value.trim().toUpperCase();
      
      if (query.length > 0) {
        searchClear.classList.add('visible');
        const results = stockDatabase.filter(stock => 
          stock.symbol.includes(query) || 
          stock.name.toUpperCase().includes(query)
        );
        showSearchResults(results);
      } else {
        searchClear.classList.remove('visible');
        showSearchResults(stockDatabase);
      }
    });

    document.addEventListener('click', (e) => {
      if (!e.target.closest('.wl-search-container')) {
        searchResults.classList.remove('visible');
      }
    });

    function clearSearch() {
      searchInput.value = '';
      searchClear.classList.remove('visible');
      searchResults.classList.remove('visible');
      searchInput.focus();
    }

    function showSearchResults(stocks) {
      if (stocks.length === 0) {
        searchResults.innerHTML = '<div class="wl-no-results">No stocks found</div>';
      } else {
        searchResults.innerHTML = stocks.map(stock => {
          const isInWatchlist = watchlist.some(s => s.symbol === stock.symbol);
          const isUp = stock.changePercent >= 0;
          
          return `
            <div class="wl-search-result" onclick="event.stopPropagation()">
              <div class="wl-result-info">
                <span class="wl-result-symbol">${stock.symbol}</span>
                <span class="wl-result-name">${stock.name}</span>
              </div>
              <div class="wl-result-sparkline">
                ${generateSparkline(stock.trend, 80, 30)}
              </div>
              <div class="wl-result-price-col">
                <div class="wl-result-price">$${stock.price.toFixed(2)}</div>
                <div class="wl-result-change ${isUp ? 'up' : 'down'}">
                  ${isUp ? '+' : ''}${stock.changePercent.toFixed(2)}%
                </div>
              </div>
              <button class="wl-star-btn ${isInWatchlist ? 'active' : ''}" onclick="toggleWatchlist('${stock.symbol}', this)">
                <svg class="star-empty" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <svg class="star-filled" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
              </button>
            </div>
          `;
        }).join('');
      }
      searchResults.classList.add('visible');
    }

    // ============================================
    // WATCHLIST
    // ============================================
    function toggleWatchlist(symbol, buttonEl) {
      const stockIndex = watchlist.findIndex(s => s.symbol === symbol);
      
      if (stockIndex > -1) {
        watchlist.splice(stockIndex, 1);
        buttonEl.classList.remove('active');
        showToast(`${symbol} removed`, 'removed');
      } else {
        const stock = stockDatabase.find(s => s.symbol === symbol);
        if (stock) {
          watchlist.push(stock);
          buttonEl.classList.add('active');
          showToast(`${symbol} added`, 'success');
          
          // Close dropdown after adding
          searchResults.classList.remove('visible');
          searchInput.value = '';
          searchInput.blur();
          searchClear.classList.remove('visible');
        }
      }
      
      localStorage.setItem('watchlist', JSON.stringify(watchlist));
      renderWatchlist();
    }

    function removeFromWatchlist(symbol) {
      watchlist = watchlist.filter(s => s.symbol !== symbol);
      localStorage.setItem('watchlist', JSON.stringify(watchlist));
      renderWatchlist();
      showToast(`${symbol} removed`, 'removed');
    }

    function renderWatchlist() {
      const container = document.getElementById('watchlist-content');
      
      if (watchlist.length === 0) {
        container.innerHTML = `
          <div class="wl-empty">
            <div class="wl-empty-icon">‚≠ê</div>
            <h3>Your watchlist is empty</h3>
            <p>Search for stocks and tap the star to add them</p>
          </div>
        `;
        updatePortfolioTotal();
        return;
      }
      
      container.innerHTML = watchlist.map(stock => {
        const isUp = stock.changePercent >= 0;
        const position = positions[stock.symbol];
        const hasPosition = position && position.shares > 0;
        const shares = hasPosition ? position.shares : 0;
        const sharesDisplay = valuesHidden ? '<span class="hidden-stars">‚òÖ‚òÖ‚òÖ</span>' : (shares + ' shares');
        
        return `
          <div class="wl-stock-row" onclick="openModal('${stock.symbol}')">
            <div class="wl-stock-info">
              <span class="wl-stock-symbol">${stock.symbol}</span>
              <span class="wl-stock-name">${hasPosition ? sharesDisplay : stock.name}</span>
            </div>
            <div class="wl-stock-sparkline">
              ${generateSparkline(stock.trend, 80, 32)}
            </div>
            <div class="wl-stock-price-col">
              <div class="wl-stock-change ${isUp ? 'up' : 'down'}">
                ${isUp ? '+' : ''}${stock.changePercent.toFixed(2)}%
              </div>
              <div class="wl-stock-price">$${stock.price.toFixed(2)}</div>
            </div>
            <button class="wl-remove-btn" onclick="event.stopPropagation(); removeFromWatchlist('${stock.symbol}')" title="Remove">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
            </button>
          </div>
        `;
      }).join('');
      
      updatePortfolioTotal();
    }

    function updatePortfolioTotal() {
      let totalMarketValue = 0;
      let totalCost = 0;
      
      watchlist.forEach(stock => {
        const position = positions[stock.symbol];
        if (position && position.shares > 0) {
          totalMarketValue += position.shares * stock.price;
          totalCost += position.shares * position.avgCost;
        }
      });
      
      const totalReturn = totalMarketValue - totalCost;
      const returnPercent = totalCost > 0 ? ((totalReturn / totalCost) * 100) : 0;
      const isGain = totalReturn >= 0;
      
      const valueEl = document.getElementById('watchlist-total-value');
      const changeEl = document.getElementById('watchlist-change');
      
      // If hidden, show stars with gunmetal shine
      if (valuesHidden) {
        valueEl.innerHTML = '<span class="hidden-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>';
        changeEl.innerHTML = '<span class="hidden-stars">‚òÖ‚òÖ‚òÖ‚òÖ</span>';
        changeEl.className = 'wl-total-change';
        return;
      }
      
      // Display total value or percentage based on toggle
      if (showPercentage && totalCost > 0) {
        valueEl.textContent = (isGain ? '+' : '') + returnPercent.toFixed(2) + '%';
      } else {
        valueEl.textContent = '$' + totalMarketValue.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      }
      
      // Display change with both $ and %
      if (totalCost > 0) {
        if (showPercentage) {
          changeEl.textContent = (isGain ? '+' : '') + '$' + Math.abs(totalReturn).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        } else {
          changeEl.textContent = (isGain ? '+' : '') + '$' + totalReturn.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' (' + (isGain ? '+' : '') + returnPercent.toFixed(2) + '%)';
        }
        changeEl.className = 'wl-total-change ' + (isGain ? '' : 'down');
      } else {
        changeEl.textContent = '+$0.00 (0.00%)';
        changeEl.className = 'wl-total-change';
      }
    }

    function toggleCollapse() {
      const stockList = document.getElementById('watchlist-content');
      const collapseBtn = document.getElementById('collapse-btn');
      
      stockList.classList.toggle('collapsed');
      collapseBtn.classList.toggle('collapsed');
    }

    // ============================================
    // HIDE VALUES (EYE TOGGLE)
    // ============================================
    let valuesHidden = localStorage.getItem('valuesHidden') === 'true';

    function toggleHideValues() {
      valuesHidden = !valuesHidden;
      localStorage.setItem('valuesHidden', valuesHidden);
      applyHiddenState();
    }

    function applyHiddenState() {
      const eyeBtn = document.getElementById('eye-btn');
      
      if (valuesHidden) {
        eyeBtn.classList.add('hidden');
      } else {
        eyeBtn.classList.remove('hidden');
      }
      
      // Re-render to apply masking
      renderWatchlist();
    }

    // ============================================
    // VALUE DISPLAY TOGGLE ($ vs %)
    // ============================================
    let showPercentage = localStorage.getItem('showPercentage') === 'true';

    function toggleValueDisplay() {
      showPercentage = !showPercentage;
      localStorage.setItem('showPercentage', showPercentage);
      updateWatchlistTotal();
    }

    // ============================================
    // MARKET SPARKLINES
    // ============================================
    function renderMarketSparklines() {
      const markets = [
        { id: 'sp500-spark', trend: 'up' },
        { id: 'dow-spark', trend: 'up' },
        { id: 'nasdaq-spark', trend: 'down' },
        { id: 'russell-spark', trend: 'up' },
        { id: 'nyse-spark', trend: 'up' }
      ];
      
      markets.forEach(market => {
        const container = document.getElementById(market.id);
        if (container) {
          container.innerHTML = generateSparkline(market.trend, 110, 30);
        }
      });
    }

    // ============================================
    // TOAST
    // ============================================
    function showToast(message, type) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = 'wl-toast ' + type;
      setTimeout(() => toast.classList.add('visible'), 10);
      setTimeout(() => toast.classList.remove('visible'), 2500);
    }

    // ============================================
    // USER PROFILE PANEL
    // ============================================
    const userProfile = {
      name: 'User',
      email: 'user@example.com',
      joinDate: 'January 12, 2026'
    };

    function loadUserProfile() {
      const saved = localStorage.getItem('apehub_user_profile');
      if (saved) {
        const data = JSON.parse(saved);
        Object.assign(userProfile, data);
      }
      
      // Check if user just came from payment
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('payment') === 'success') {
        const email = localStorage.getItem('userEmail');
        if (email) {
          userProfile.email = email;
          // Extract name from email
          userProfile.name = email.split('@')[0].charAt(0).toUpperCase() + email.split('@')[0].slice(1);
          // Save updated profile
          localStorage.setItem('apehub_user_profile', JSON.stringify(userProfile));
          // Remove payment param from URL
          window.history.replaceState({}, document.title, window.location.pathname);
        }
      }
      
      updateProfileDisplay();
      checkSubscriptionStatus();
    }

    function checkSubscriptionStatus() {
      // For now, we'll mark user as subscribed if they just paid
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('payment') === 'success') {
        const subscriptionBanner = document.createElement('div');
        subscriptionBanner.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          background: linear-gradient(135deg, #10b981 0%, #059669 100%);
          color: white;
          padding: 16px 24px;
          text-align: center;
          font-weight: 600;
          z-index: 9999;
          animation: slideDown 0.3s ease-out;
        `;
        subscriptionBanner.innerHTML = '‚úì Subscription activated! Welcome to premium access.';
        document.body.insertBefore(subscriptionBanner, document.body.firstChild);
        
        // Add animation
        const style = document.createElement('style');
        style.textContent = `
          @keyframes slideDown {
            from {
              transform: translateY(-100%);
              opacity: 0;
            }
            to {
              transform: translateY(0);
              opacity: 1;
            }
          }
        `;
        document.head.appendChild(style);
        
        // Remove banner after 5 seconds
        setTimeout(() => {
          subscriptionBanner.style.animation = 'slideDown 0.3s ease-out reverse';
          setTimeout(() => subscriptionBanner.remove(), 300);
        }, 5000);
        
        // Add subscription badge to profile
        userProfile.subscribed = true;
        localStorage.setItem('apehub_user_profile', JSON.stringify(userProfile));
      } else {
        // Check if already subscribed
        if (userProfile.subscribed) {
          console.log('User has active subscription');
        }
      }
    }

    function updateProfileDisplay() {
      const initial = userProfile.name.charAt(0).toUpperCase();
      document.getElementById('userName').textContent = userProfile.name;
      document.getElementById('profileAvatar').textContent = initial;
      document.getElementById('profileName').textContent = userProfile.name;
      document.getElementById('infoName').textContent = userProfile.name;
      document.getElementById('infoEmail').textContent = userProfile.email;
      document.getElementById('infoJoined').textContent = userProfile.joinDate;
    }

    function openProfile() {
      document.getElementById('profileOverlay').classList.add('active');
      document.getElementById('profilePanel').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeProfile() {
      document.getElementById('profileOverlay').classList.remove('active');
      document.getElementById('profilePanel').classList.remove('active');
      document.body.style.overflow = '';
    }

    // ============================================
    // SUPPORT CHAT
    // ============================================
    let chatMessages = [];

    function loadChatMessages() {
      const saved = localStorage.getItem('apehub_support_chat');
      if (saved) {
        chatMessages = JSON.parse(saved);
        renderChatMessages();
      }
    }

    function saveChatMessages() {
      localStorage.setItem('apehub_support_chat', JSON.stringify(chatMessages));
    }

    function renderChatMessages() {
      const container = document.getElementById('chatMessages');
      container.innerHTML = `
        <div class="chat-message support">
          Hi! üëã Welcome to ApeHub support. How can I help you today?
          <div class="chat-message-time">Support Team</div>
        </div>
      `;
      
      chatMessages.forEach(msg => {
        const div = document.createElement('div');
        div.className = `chat-message ${msg.type}`;
        div.innerHTML = `
          ${msg.text}
          <div class="chat-message-time">${msg.time}</div>
        `;
        container.appendChild(div);
      });
      
      container.scrollTop = container.scrollHeight;
    }

    function sendSupportMessage() {
      const input = document.getElementById('chatInput');
      const text = input.value.trim();
      if (!text) return;

      const now = new Date();
      const time = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });

      // Add user message
      chatMessages.push({ type: 'user', text, time });
      input.value = '';
      renderChatMessages();
      saveChatMessages();

      // Simulate support response after delay
      setTimeout(() => {
        const responses = [
          "Thanks for reaching out! I've noted your concern and our team will look into it.",
          "Got it! We appreciate your feedback. Is there anything else I can help with?",
          "Thank you for your message! Our team typically responds within 24 hours for detailed inquiries.",
          "I understand. Let me check on that for you. You'll receive an update via email shortly.",
          "Thanks for letting us know! We're always working to improve ApeHub."
        ];
        const response = responses[Math.floor(Math.random() * responses.length)];
        const responseTime = new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
        
        chatMessages.push({ type: 'support', text: response, time: 'Support Team' });
        renderChatMessages();
        saveChatMessages();
      }, 1500);
    }

    function handleChatKeypress(e) {
      if (e.key === 'Enter') {
        sendSupportMessage();
      }
    }

    function handleLogout() {
      if (confirm('Are you sure you want to sign out?')) {
        showToast('Signed out successfully', 'success');
        closeProfile();
      }
    }

    // ============================================
    // THEME SWITCHING
    // ============================================
    function loadTheme() {
      const savedTheme = localStorage.getItem('apehub_theme') || 'dark';
      document.documentElement.setAttribute('data-theme', savedTheme);
      const toggle = document.getElementById('themeToggle');
      const label = document.getElementById('themeLabel');
      if (toggle) {
        toggle.checked = savedTheme === 'light';
      }
      if (label) {
        label.textContent = savedTheme === 'light' ? 'Light mode' : 'Dark mode';
      }
    }

    function toggleTheme() {
      const toggle = document.getElementById('themeToggle');
      const newTheme = toggle.checked ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('apehub_theme', newTheme);
      document.getElementById('themeLabel').textContent = newTheme === 'light' ? 'Light mode' : 'Dark mode';
    }

    // Load saved theme from localStorage
    (function() {
      const savedTheme = localStorage.getItem('apehub_theme') || 'dark';
      document.documentElement.setAttribute('data-theme', savedTheme);
    })();

    // ============================================
    // INITIALIZE
    // ============================================
    document.addEventListener('DOMContentLoaded', function() {
      updateClock();
      setInterval(updateClock, 1000);
      renderMarketSparklines();
      renderWatchlist();
      applyHiddenState();
      loadUserProfile();
      loadChatMessages();
      loadTheme();
      
      // Fetch real-time data immediately (force update)
      updateIndices();
      updateWatchlistPrices(true); // Force update on page load
      
      // Refresh prices every 60 seconds
      setInterval(() => {
        updateIndices();
        updateWatchlistPrices(true);
      }, 60000);
    });
  </script>
</body>
</html>